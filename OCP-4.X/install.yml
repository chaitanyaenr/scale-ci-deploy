---
#
# Install OCP 4.x playbook.
#

- hosts: orchestration
  user: "{{ orchestration_user | default('root') }}"
  vars_files:
    - vars/install.yml
  roles:
    - role: cleanup
      when: (openshift_aws_install_cleanup | default(False) | bool) or (openshift_libvirt_install_cleanup | default(False) | bool)
    - role: install
      when: openshift_install | default(True) | bool
    - role: quickstart
      when: openshift_install | default(True) | bool
    - role: post-install
      when: openshift_post_install | default(False) | bool
    - role: post-config
      when: openshift_tooling | default(False) | bool

- hosts: workload
  remote_user: "{{ openshift_install_user| default('core') }}"
  become: true
  vars_files:
    - vars/install.yml
  roles:
    - role: workload-kickstart
      when: openshift_debug_tooling | default(False) | bool

- hosts: nodes
  remote_user: "{{ openshift_install_user | default('core') }}"
  become: true
  vars_files:
    - vars/install.yml
  roles:
    - role: node-config
      when: openshift_debug_tooling | default(False) | bool
